<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é¢˜ç›®æ•°æ®æ¸²æŸ“æµ‹è¯•</title>
  <style>
      body { font-family: sans-serif; background: #f0f2f5; padding: 20px; }
      .container { max-width: 800px; margin: 0 auto; }

      .card {
          background: white;
          border-radius: 12px;
          padding: 24px;
          margin-bottom: 24px;
          box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      }

      .badge {
          background: #e6f7ff; color: #1890ff;
          padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: bold;
      }

      .question-content { margin: 16px 0; font-size: 16px; line-height: 1.6; }

      /* å›¾ç‰‡å®¹å™¨æ ·å¼ */
      .generated-image {
          display: block;
          max-width: 100%;
          margin: 10px 0;
          border: 1px dashed #ccc; /* è™šçº¿æ¡†è¡¨ç¤ºè¿™æ˜¯ç”Ÿæˆçš„å›¾ç‰‡ */
          padding: 5px;
          border-radius: 8px;
      }

      .options { list-style: none; padding: 0; }
      .option-item {
          padding: 10px; border: 1px solid #eee; margin-bottom: 8px;
          border-radius: 6px; display: flex; flex-direction: column;
      }
      .option-label { font-weight: bold; margin-right: 10px; color: #555; }

      .error-msg { color: red; background: #fff1f0; padding: 20px; border-radius: 8px; display: none;}
  </style>
</head>
<body>

<div class="container">
  <h1>ğŸ” JSON æ•°æ®æ¸²æŸ“é¢„è§ˆ</h1>
  <div id="error-box" class="error-msg"></div>
  <div id="app"></div>
</div>

<script>
  // æ ¸å¿ƒæ¸²æŸ“é€»è¾‘
  async function loadData() {
    try {
      // è¯·æ±‚åŒç›®å½•ä¸‹çš„ processed_questions.json
      const response = await fetch('./processed_questions.json');

      if (!response.ok) {
        throw new Error(`HTTP error! status: ${response.status}`);
      }

      const data = await response.json();
      renderQuestions(data);

    } catch (error) {
      const errorBox = document.getElementById('error-box');
      errorBox.style.display = 'block';
      errorBox.innerHTML = `
                <h3>âš ï¸ æ— æ³•åŠ è½½æ•°æ®</h3>
                <p>é”™è¯¯ä¿¡æ¯: ${error.message}</p>
                <p><strong>è§£å†³æ–¹æ³•ï¼š</strong> æµè§ˆå™¨å‡ºäºå®‰å…¨ç­–ç•¥ï¼Œé€šå¸¸ä¸å…è®¸ç›´æ¥è¯»å–æœ¬åœ° JSON æ–‡ä»¶ (file:// åè®®)ã€‚</p>
                <p>è¯·åœ¨ scripts ç›®å½•ä¸‹æ‰“å¼€ç»ˆç«¯ï¼Œè¿è¡Œä»¥ä¸‹ Python å‘½ä»¤å¯åŠ¨ä¸€ä¸ªä¸´æ—¶æœåŠ¡å™¨ï¼š</p>
                <code>python -m http.server</code>
                <p>ç„¶ååœ¨æµè§ˆå™¨è®¿é—®ï¼š <a href="http://localhost:8000/view.html">http://localhost:8000/view.html</a></p>
            `;
    }
  }

  function renderQuestions(questions) {
    const app = document.getElementById('app');

    questions.forEach((q, index) => {
      const card = document.createElement('div');
      card.className = 'card';

      // æ¸²æŸ“é¢˜å¹²
      let contentHtml = `<p>${q.content}</p>`;
      // æ£€æŸ¥æ˜¯å¦æœ‰ content_image å­—æ®µ
      if (q.content_image) {
        contentHtml += `<img src="${q.content_image}" class="generated-image" alt="é¢˜å¹²é…å›¾">`;
      }

      // æ¸²æŸ“é€‰é¡¹
      let optionsHtml = '<ul class="options">';
      q.options.forEach(opt => {
        let optImgHtml = '';
        // æ£€æŸ¥é€‰é¡¹æ˜¯å¦æœ‰å›¾ç‰‡
        if (opt.option_image) {
          optImgHtml = `<img src="${opt.option_image}" class="generated-image" style="max-width: 100px;">`;
        }
        optionsHtml += `
                    <li class="option-item">
                        <div><span class="option-label">${opt.label}.</span> ${opt.text}</div>
                        ${optImgHtml}
                    </li>`;
      });
      optionsHtml += '</ul>';

      card.innerHTML = `
                <div><span class="badge">ID: ${q.id}</span></div>
                <div class="question-content">${contentHtml}</div>
                ${optionsHtml}
                <div style="margin-top:10px; color:#888; font-size:0.9em;">
                    æ­£ç¡®ç­”æ¡ˆ: <strong>${q.answer}</strong>
                </div>
            `;

      app.appendChild(card);
    });
  }

  // å¯åŠ¨åŠ è½½
  loadData();
</script>

</body>
</html>